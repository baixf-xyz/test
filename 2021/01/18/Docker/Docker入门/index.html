

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/pi.jpg">
  <link rel="icon" type="image/png" href="/img/pi.jpg">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="白小飞">
  <meta name="keywords" content="">
  <title>Docker入门 - 白小飞のblog</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.5.3/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.1.2/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"blog.baixf.tk","root":"/","version":"1.8.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"copy_btn":true,"image_zoom":{"enable":true},"lazyload":{"enable":true,"onlypost":false},"web_analytics":{"enable":true,"baidu":"32cfe221d23ea3ac2ca847f1e865c570","google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.2.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>白小飞のBlog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner intro-2" id="background" parallax=true
         style="background: url('https://gitee.com/bai_xiao_fei/picture/raw/master/PicGo/docker banner.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="Docker入门">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-01-18 13:02" pubdate>
        2021年1月18日 下午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      10.9k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      169
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Docker入门</h1>
            
            <div class="markdown-body">
              <h2 id="Docker容器学习笔记Ⅰ（狂神说Java）"><a href="#Docker容器学习笔记Ⅰ（狂神说Java）" class="headerlink" title="Docker容器学习笔记Ⅰ（狂神说Java）"></a>Docker容器学习笔记Ⅰ（狂神说Java）</h2><p>狂神说B站视频：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1og4y1q7M4?p=1">https://www.bilibili.com/video/BV1og4y1q7M4?p=1</a></p>
<p>学习docker：<a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-tutorial.html">https://www.runoob.com/docker/docker-tutorial.html</a></p>
<p>使用docker：<a target="_blank" rel="noopener" href="https://labs.play-with-docker.com/">https://labs.play-with-docker.com/</a></p>
<h2 id="一、大纲"><a href="#一、大纲" class="headerlink" title="一、大纲"></a>一、大纲</h2><p><strong>入门：</strong></p>
<ul>
<li><p>Docker概述</p>
</li>
<li><p>Docker安装</p>
</li>
<li><p>Docker命令</p>
<ul>
<li>镜像命令</li>
<li>容器命令</li>
<li>操作命令</li>
<li>……</li>
</ul>
</li>
<li><p>Docker镜像</p>
</li>
</ul>
<p><strong>精髓：</strong></p>
<ul>
<li><p>容器数据卷</p>
</li>
<li><p>DockerFile</p>
</li>
<li><p>Docker网络原理</p>
</li>
</ul>
<p><strong>企业级：</strong></p>
<ul>
<li><p>IDEA整合Docker</p>
</li>
<li><p>集群</p>
<ul>
<li>Docker Compose</li>
<li>Docker Swarm</li>
</ul>
</li>
<li><p>CI/CD Jenkins流水线</p>
</li>
</ul>
<h2 id="二、Docker概述"><a href="#二、Docker概述" class="headerlink" title="二、Docker概述"></a>二、Docker概述</h2><p><strong>1.Docker为什么会出现？</strong></p>
<p>一款产品： 开发–上线 两套环境！应用环境，应用配置！</p>
<p>开发 — 运维。 问题：我在我的电脑上可以允许！版本更新，导致服务不可用！对于运维来说考验十分大？</p>
<p>环境配置是十分的麻烦，每一个机器都要部署环境(集群Redis、ES、Hadoop…) !费事费力。<br>发布一个项目( jar + (Redis MySQL JDK ES) )，项目能不能带上环境安装打包！</p>
<p>之前在服务器配置一个应用的环境 Redis MySQL JDK ES Hadoop 配置超麻烦了，不能够跨平台。</p>
<p>开发环境Windows，最后发布到Linux！</p>
<p>传统：开发jar，运维来做！</p>
<p>现在：开发打包部署上线，一套流程做完！</p>
<p>安卓流程：java — apk —发布（应用商店）一 张三使用apk一安装即可用！</p>
<p>docker流程： java-jar（环境） — 打包项目帯上环境（镜像） — ( Docker仓库：商店）——-</p>
<p>Docker给以上的问题，提出了解决方案！</p>
<p>Docker的思想就来自于集装箱！</p>
<p>JRE – 多个应用(端口冲突) – 原来都是交叉的！</p>
<p>隔离：Docker核心思想！打包装箱！每个箱子是互相隔离的。</p>
<p>Docker通过隔离机制，可以将服务器利用到极致！</p>
<p>本质：所有的技术都是因为出现了一些问题，我们需要去解决，才去学习！</p>
<p><strong>2.Dcoker的历史</strong></p>
<p>2010年，几个的年轻人，就在美国成立了一家公司 dotcloud</p>
<p>做一些pass的云计算服务！LXC（Linux Container容器）有关的容器技术！</p>
<ul>
<li>Linux Container容器是一种内核虚拟化技术，可以提供轻量级的虚拟化，以便隔离进程和资源。</li>
</ul>
<p>他们将自己的技术（容器化技术）命名就是 Docker。</p>
<p>Docker刚刚延生的时候，没有引起行业的注意！dotCloud，就活不下去！</p>
<ul>
<li>开源</li>
</ul>
<p>2013年，Docker开源！</p>
<p>越来越多的人发现docker的优点！火了。Docker每个月都会更新一个版本！</p>
<p>2014年4月9日，Docker1.0发布！</p>
<p><strong>docker为什么这么火？</strong>十分的轻巧！</p>
<p>在容器技术出来之前，我们都是使用虚拟机技术！</p>
<p>虚拟机：在window中装一个VMware，通过这个软件我们可以虚拟出来一台或者多台电脑！笨重！</p>
<p>虚拟机也属于虚拟化技术，Docker容器技术，也是一种虚拟化技术！</p>
<ul>
<li><p>vm : linux centos 原生镜像（一个电脑！） 隔离、需要开启多个虚拟机！ 几个G 几分钟</p>
</li>
<li><p>docker: 隔离，镜像（最核心的环境 4m + jdk + mysql）十分的小巧，运行镜像就可以了！小巧！几个M 秒级启动！</p>
</li>
</ul>
<p>Docker基于Go语言开发的！开源项目！</p>
<p>docker官网：<a target="_blank" rel="noopener" href="https://www.docker.com/">https://www.docker.com/</a></p>
<p>文档：<a target="_blank" rel="noopener" href="https://docs.docker.com/">https://docs.docker.com/</a> Docker的文档是超级详细的！</p>
<p>仓库：<a target="_blank" rel="noopener" href="https://hub.docker.com/">https://hub.docker.com/</a></p>
<p><strong>3.Docker能做什么？</strong></p>
<p>比较Docker和虚拟机技术的不同：</p>
<ul>
<li><p>传统虚拟机，虚拟出一条硬件，运行一个完整的操作系统，然后在这个系统上安装和运行软件</p>
</li>
<li><p>容器内的应用直接运行在宿主机的内容，容器是没有自己的内核的，也没有虚拟我们的硬件，所以就轻便了</p>
</li>
<li><p>每个容器间是互相隔离，每个容器内都有一个属于自己的文件系统，互不影响</p>
</li>
</ul>
<p><strong>4.DevOps（开发、运维）</strong></p>
<ul>
<li>应用更快速的交付和部署</li>
</ul>
<p>传统：一对帮助文档，安装程序。</p>
<p>Docker：打包镜像发布测试一键运行。</p>
<ul>
<li>更便捷的升级和扩缩容</li>
</ul>
<p>使用了 Docker之后，我们部署应用就和搭积木一样</p>
<p>项目打包为一个镜像，扩展服务器A！服务器B</p>
<ul>
<li>更简单的系统运维</li>
</ul>
<p>在容器化之后，我们的开发，测试环境都是高度一致的</p>
<ul>
<li>更高效的计算资源利用</li>
</ul>
<p>Docker是内核级别的虚拟化，可以在一个物理机上可以运行很多的容器实例！服务器的性能可以被压榨到极致。</p>
<h2 id="三、Docker安装"><a href="#三、Docker安装" class="headerlink" title="三、Docker安装"></a>三、Docker安装</h2><p><strong>1.Docker的基本组成</strong></p>
<p><img src="https://gitee.com/bai_xiao_fei/picture/raw/master/PicGo/u=1947627492,1772063185&amp;fm=26&amp;gp=0.jpg" srcset="/img/loading.gif" alt=""></p>
<ul>
<li>镜像（image)：</li>
</ul>
<p>docker镜像就好比是一个目标，可以通过这个目标来创建容器服务，tomcat镜像==&gt;run==&gt;容器（提供服务器），通过这个镜像可以创建多个容器（最终服务运行或者项目运行就是在容器中的）。</p>
<ul>
<li>容器(container)：</li>
</ul>
<p>Docker利用容器技术，独立运行一个或者一组应用，通过镜像来创建的.<br>启动，停止，删除，基本命令<br>目前就可以把这个容器理解为就是一个简易的 Linux系统。</p>
<ul>
<li>仓库(repository)：</li>
</ul>
<p>仓库就是存放镜像的地方！</p>
<p>仓库分为公有仓库和私有仓库。(很类似git)</p>
<p>Docker Hub是国外的。</p>
<p>阿里云…都有容器服务器(配置镜像加速!)</p>
<p><strong>2.安装Docker</strong></p>
<ul>
<li>环境准备</li>
</ul>
<p>Linux要求内核3.0以上</p>
<pre><code class="hljs shell">pi@raspbian:~$ uname -r
5.4.83-OPENFANS+20210102-v8
pi@raspbian:~$ cat /etc/os-release
PRETTY_NAME=&quot;Debian GNU/Linux 10 (buster)&quot;
NAME=&quot;Debian GNU/Linux&quot;
VERSION_ID=&quot;10&quot;
VERSION=&quot;10 (buster)&quot;
VERSION_CODENAME=buster
ID=debian
HOME_URL=&quot;https://www.debian.org/&quot;
SUPPORT_URL=&quot;https://www.debian.org/support&quot;
BUG_REPORT_URL=&quot;https://bugs.debian.org/&quot;</code></pre>
<ul>
<li>安装</li>
</ul>
<pre><code class="hljs shell">帮助文档：https://docs.docker.com/engine/install/</code></pre>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">1.卸载旧版本</span>
sudo apt-get install \
    apt-transport-https \
    ca-certificates \
    curl \
    gnupg-agent \
    software-properties-common
<span class="hljs-meta">#</span><span class="bash">2.添加Docker的官方GPG密钥</span>
curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add -
sudo apt-key fingerprint 0EBFCD88
<span class="hljs-meta">#</span><span class="bash">3.设置镜像的仓库</span>
sudo add-apt-repository \
   &quot;deb [arch=arm64] https://download.docker.com/linux/debian \
<span class="hljs-meta">   $</span><span class="bash">(lsb_release -cs) \</span>
   stable&quot;
<span class="hljs-meta">#</span><span class="bash">默认是从国外的，不推荐</span>
<span class="hljs-meta">#</span><span class="bash">推荐使用国内的</span>
sudo add-apt-repository \
   &quot;deb [arch=amd64] http://mirrors.aliyun.com/docker-ce/linux/debian \
<span class="hljs-meta">   $</span><span class="bash">(lsb_release -cs) \</span>
   stable&quot;
<span class="hljs-meta">#</span><span class="bash">更新yum软件包索引</span>
yum makecache fast
<span class="hljs-meta">#</span><span class="bash">4.安装docker相关的 docker-ce 社区版 而ee是企业版</span>
sudo apt-get install docker-ce docker-ce-cli containerd.io</code></pre>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">5. 使用docker version查看是否按照成功</span>
pi@raspbian:~$ docker version
Client: Docker Engine - Community
 Version:           20.10.1
 API version:       1.41
 Go version:        go1.13.15
 Git commit:        831ebea
 Built:             Tue Dec 15 04:35:39 2020
 OS/Arch:           linux/arm64
 Context:           default
 Experimental:      true

Server: Docker Engine - Community
 Engine:
  Version:          20.10.1
  API version:      1.41 (minimum version 1.12)
  Go version:       go1.13.15
  Git commit:       f001486
  Built:            Tue Dec 15 04:33:40 2020
  OS/Arch:          linux/arm64
  Experimental:     false
 containerd:
  Version:          1.4.3
  GitCommit:        269548fa27e0089a8b8278fc4fc781d7f65a939b
 runc:
  Version:          1.0.0-rc92
  GitCommit:        ff819c7e9184c13b7c2607fe6c30ae19403a7aff
 docker-init:
  Version:          0.19.0
  GitCommit:        de40ad0</code></pre>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">6. 测试</span>
pi@raspbian:~$ docker run hello-world
Unable to find image &#x27;hello-world:latest&#x27; locally
latest: Pulling from library/hello-world
256ab8fe8778: Already exists 
Digest: sha256:31b9c7d48790f0d8c50ab433d9c3b7e17666d6993084c002c2ff1ca09b96391d
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.
    (arm64v8)
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
<span class="hljs-meta"> $</span><span class="bash"> docker run -it ubuntu bash</span>

Share images, automate workflows, and more with a free Docker ID:
 https://hub.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/get-started/</code></pre>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">8.查看一下下载的镜像</span>
pi@raspbian:~$ docker images
REPOSITORY    TAG       IMAGE ID       CREATED         SIZE
hello-world   latest    a29f45ccde2a   12 months ago   9.14kB</code></pre>
<p>了解：卸载docker</p>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">1. 卸载依赖</span>
yum remove docker-ce docker-ce-cli containerd.io
<span class="hljs-meta">#</span><span class="bash">2. 删除资源</span>
rm -rf /var/lib/docker
<span class="hljs-meta">#</span><span class="bash"> /var/lib/docker 是docker的默认工作路径！</span></code></pre>
<ul>
<li>阿里云镜像加速</li>
</ul>
<p>1、登录阿里云找到容器服务</p>
<p><a target="_blank" rel="noopener" href="https://cr.console.aliyun.com/cn-shanghai/instances/mirrors">镜像加速器</a></p>
<p>2、找到镜像加速器</p>
<p><img src="https://gitee.com/bai_xiao_fei/picture/raw/master/PicGo/QQ%E6%88%AA%E5%9B%BE20210117214418.png" srcset="/img/loading.gif" alt=""></p>
<p>3、配置使用</p>
<pre><code class="hljs shell">sudo mkdir -p /etc/docker
sudo tee /etc/docker/daemon.json &lt;&lt;-&#x27;EOF&#x27;
&#123;
  &quot;registry-mirrors&quot;: [&quot;https://mabtc1tu.mirror.aliyuncs.com&quot;]
&#125;
EOF
sudo systemctl daemon-reload
sudo systemctl restart docker</code></pre>
<p><strong>3.底层原理</strong></p>
<ul>
<li><strong>Docker是怎么工作的？</strong></li>
</ul>
<p>Docker是一个Client-Server结构的系统，Docker的守护进程运行在主机上。通过Socket从客户端访问！</p>
<p>Docker-Server接收到Docker-Client的指令，就会执行这个命令！</p>
<p><img src="https://gitee.com/bai_xiao_fei/picture/raw/master/PicGo/QQ%E6%88%AA%E5%9B%BE20210117214806.png" srcset="/img/loading.gif" alt=""></p>
<ul>
<li><strong>为什么Docker比Vm快</strong></li>
</ul>
<p>1、docker有着比虚拟机更少的抽象层。由于docker不需要Hypervisor实现硬件资源虚拟化,运行在docker容器上的程序直接使用的都是实际物理机的硬件资源。因此在CPU、内存利用率上docker将会在效率上有明显优势。</p>
<p>2、docker利用的是宿主机的内核,而不需要Guest OS。</p>
<p>GuestOS： VM（虚拟机）里的的系统（OS）;</p>
<p>HostOS：物理机里的系统（OS）；</p>
<p><img src="https://gitee.com/bai_xiao_fei/picture/raw/master/PicGo/src=http___img2018.cnblogs.com_i-beta_1931096_202002_1931096-20200208093654447-2072313478.png&amp;refer=http___img2018.cnblogs.jpg" srcset="/img/loading.gif" alt=""></p>
<p>因此,当新建一个 容器时，docker不需要和虚拟机一样重新加载一个操作系统内核。然而避免引导、加载操作系统内核是个比较费时费资源的过程，当新建一个虚拟机时，虚拟机软件需要加载GuestOS，整个新建过程是分钟级别的。而docker由于直接利用宿主机的操作系统,则省略了这个复杂的过程，因此新建一个docker容器只需要几秒钟。</p>
<h2 id="三、Docker的常用命令"><a href="#三、Docker的常用命令" class="headerlink" title="三、Docker的常用命令"></a>三、Docker的常用命令</h2><p><strong>1.帮助命令</strong></p>
<pre><code class="hljs shell">docker version #显示docker的版本信息。</code></pre>
<pre><code class="hljs shell">pi@raspbian:~$ docker version
Client: Docker Engine - Community
 Version:           20.10.1
 API version:       1.41
 Go version:        go1.13.15
 Git commit:        831ebea
 Built:             Tue Dec 15 04:35:39 2020
 OS/Arch:           linux/arm64
 Context:           default
 Experimental:      true

Server: Docker Engine - Community
 Engine:
  Version:          20.10.1
  API version:      1.41 (minimum version 1.12)
  Go version:       go1.13.15
  Git commit:       f001486
  Built:            Tue Dec 15 04:33:40 2020
  OS/Arch:          linux/arm64
  Experimental:     false
 containerd:
  Version:          1.4.3
  GitCommit:        269548fa27e0089a8b8278fc4fc781d7f65a939b
 runc:
  Version:          1.0.0-rc92
  GitCommit:        ff819c7e9184c13b7c2607fe6c30ae19403a7aff
 docker-init:
  Version:          0.19.0
  GitCommit:        de40ad0</code></pre>
<pre><code class="hljs shell">docker info #显示docker的系统信息，包括镜像和容器的数量</code></pre>
<pre><code class="hljs shell">pi@raspbian:~$ docker info
Client:
 Context:    default
 Debug Mode: false
 Plugins:
  app: Docker App (Docker Inc., v0.9.1-beta3)
  buildx: Build with BuildKit (Docker Inc., v0.5.0-docker)

Server:
 Containers: 6
  Running: 0
  Paused: 0
  Stopped: 6
 Images: 1
 Server Version: 20.10.1
 Storage Driver: overlay2
  Backing Filesystem: extfs
  Supports d_type: true
  Native Overlay Diff: true
 Logging Driver: json-file
 Cgroup Driver: cgroupfs
 Cgroup Version: 1
 Plugins:
  Volume: local
  Network: bridge host ipvlan macvlan null overlay
  Log: awslogs fluentd gcplogs gelf journald json-file local logentries splunk syslog
 Swarm: inactive
 Runtimes: io.containerd.runc.v2 io.containerd.runtime.v1.linux runc
 Default Runtime: runc
 Init Binary: docker-init
 containerd version: 269548fa27e0089a8b8278fc4fc781d7f65a939b
 runc version: ff819c7e9184c13b7c2607fe6c30ae19403a7aff
 init version: de40ad0
 Security Options:
  seccomp
   Profile: default
 Kernel Version: 5.4.83-OPENFANS+20210102-v8
 Operating System: Debian GNU/Linux 10 (buster)
 OSType: linux
 Architecture: aarch64
 CPUs: 4
 Total Memory: 1.805GiB
 Name: raspbian
 ID: EUR5:D5VI:P5K6:JRE3:4YIL:POWU:QAFS:YLRT:SFV6:6ZI5:EJPM:NSLC
 Docker Root Dir: /var/lib/docker
 Debug Mode: false
 Username: baixfxyz
 Registry: https://index.docker.io/v1/
 Labels:
 Experimental: false
 Insecure Registries:
  127.0.0.0/8
 Registry Mirrors:
  http://hub-mirror.c.163.com/
 Live Restore Enabled: false

WARNING: No blkio weight support
WARNING: No blkio weight_device support
WARNING: bridge-nf-call-ip6tables is disabled</code></pre>
<pre><code class="hljs shell">docker 命令 --help #帮助命令
docker --help</code></pre>
<pre><code class="hljs shell">pi@raspbian:~$ docker --help

Usage:  docker [OPTIONS] COMMAND

A self-sufficient runtime for containers

Options:
      --config string      Location of client config files (default &quot;/home/pi/.docker&quot;)
  -c, --context string     Name of the context to use to connect to the daemon (overrides DOCKER_HOST env
                           var and default context set with &quot;docker context use&quot;)
  -D, --debug              Enable debug mode
  -H, --host list          Daemon socket(s) to connect to
  -l, --log-level string   Set the logging level (&quot;debug&quot;|&quot;info&quot;|&quot;warn&quot;|&quot;error&quot;|&quot;fatal&quot;) (default &quot;info&quot;)
      --tls                Use TLS; implied by --tlsverify
      --tlscacert string   Trust certs signed only by this CA (default &quot;/home/pi/.docker/ca.pem&quot;)
      --tlscert string     Path to TLS certificate file (default &quot;/home/pi/.docker/cert.pem&quot;)
      --tlskey string      Path to TLS key file (default &quot;/home/pi/.docker/key.pem&quot;)
      --tlsverify          Use TLS and verify the remote
  -v, --version            Print version information and quit

Management Commands:
  app*        Docker App (Docker Inc., v0.9.1-beta3)
  builder     Manage builds
  buildx*     Build with BuildKit (Docker Inc., v0.5.0-docker)
  config      Manage Docker configs
  container   Manage containers
  context     Manage contexts
  image       Manage images
  manifest    Manage Docker image manifests and manifest lists
  network     Manage networks
  node        Manage Swarm nodes
  plugin      Manage plugins
  secret      Manage Docker secrets
  service     Manage services
  stack       Manage Docker stacks
  swarm       Manage Swarm
  system      Manage Docker
  trust       Manage trust on Docker images
  volume      Manage volumes

Commands:
  attach      Attach local standard input, output, and error streams to a running container
  build       Build an image from a Dockerfile
  commit      Create a new image from a container&#x27;s changes
  cp          Copy files/folders between a container and the local filesystem
  create      Create a new container
  diff        Inspect changes to files or directories on a container&#x27;s filesystem
  events      Get real time events from the server
  exec        Run a command in a running container
  export      Export a container&#x27;s filesystem as a tar archive
  history     Show the history of an image
  images      List images
  import      Import the contents from a tarball to create a filesystem image
  info        Display system-wide information
  inspect     Return low-level information on Docker objects
  kill        Kill one or more running containers
  load        Load an image from a tar archive or STDIN
  login       Log in to a Docker registry
  logout      Log out from a Docker registry
  logs        Fetch the logs of a container
  pause       Pause all processes within one or more containers
  port        List port mappings or a specific mapping for the container
  ps          List containers
  pull        Pull an image or a repository from a registry
  push        Push an image or a repository to a registry
  rename      Rename a container
  restart     Restart one or more containers
  rm          Remove one or more containers
  rmi         Remove one or more images
  run         Run a command in a new container
  save        Save one or more images to a tar archive (streamed to STDOUT by default)
  search      Search the Docker Hub for images
  start       Start one or more stopped containers
  stats       Display a live stream of container(s) resource usage statistics
  stop        Stop one or more running containers
  tag         Create a tag TARGET_IMAGE that refers to SOURCE_IMAGE
  top         Display the running processes of a container
  unpause     Unpause all processes within one or more containers
  update      Update configuration of one or more containers
  version     Show the Docker version information
  wait        Block until one or more containers stop, then print their exit codes

Run &#x27;docker COMMAND --help&#x27; for more information on a command.

To get more help with docker, check out our guides at https://docs.docker.com/go/guides/</code></pre>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">帮助文档的地址：https://docs.docker.com/engine/reference/commandline/build/</span></code></pre>
<p><strong>2.镜像命令</strong></p>
<pre><code class="hljs shell">docker images #查看所有本地主机上的镜像 可以使用docker image ls代替
docker search 搜索镜像
docker pull 下载镜像 docker image pull
docker rmi 删除镜像 docker image rm</code></pre>
<p><strong>docker images 查看所有本地的主机上的镜像</strong></p>
<pre><code class="hljs shell">pi@raspbian:~$ docker images
REPOSITORY    TAG       IMAGE ID       CREATED         SIZE
hello-world   latest    a29f45ccde2a   12 months ago   9.14kB</code></pre>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 解释</span>
<span class="hljs-meta">#</span><span class="bash">REPOSITORY <span class="hljs-comment"># 镜像的仓库源</span></span>
<span class="hljs-meta">#</span><span class="bash">TAG <span class="hljs-comment"># 镜像的标签</span></span>
<span class="hljs-meta">#</span><span class="bash">IMAGE ID <span class="hljs-comment"># 镜像的id</span></span>
<span class="hljs-meta">#</span><span class="bash">CREATED <span class="hljs-comment"># 镜像的创建时间</span></span>
<span class="hljs-meta">#</span><span class="bash">SIZE <span class="hljs-comment"># 镜像的大小</span></span></code></pre>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 可选项</span>
pi@raspbian:~$ docker images --help
Usage:  docker images [OPTIONS] [REPOSITORY[:TAG]]

List images

Options:
  -a, --all             Show all images (default hides intermediate images) #列出所有镜像
      --digests         Show digests
  -f, --filter filter   Filter output based on conditions provided
      --format string   Pretty-print images using a Go template
      --no-trunc        Don&#x27;t truncate output
  -q, --quiet           Only show image IDs # 只显示镜像的id</code></pre>
<pre><code class="hljs shell">pi@raspbian:~$ docker images -aq ＃显示所有镜像的id
a29f45ccde2a</code></pre>
<p><strong>docker pull 下载镜像</strong></p>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 下载镜像 docker pull 镜像名[:tag]</span>

➜ ~ docker pull tomcat:8
8: Pulling from library/tomcat #如果不写tag，默认就是latest
90fe46dd8199: Already exists #分层下载： docker image 的核心 联合文件系统
35a4f1977689: Already exists
bbc37f14aded: Already exists
74e27dc593d4: Already exists
93a01fbfad7f: Already exists
1478df405869: Pull complete
64f0dd11682b: Pull complete
68ff4e050d11: Pull complete
f576086003cf: Pull complete
3b72593ce10e: Pull complete
Digest: sha256:0c6234e7ec9d10ab32c06423ab829b32e3183ba5bf2620ee66de866df640a027
<span class="hljs-meta">#</span><span class="bash"> 签名 防伪</span>
Status: Downloaded newer image for tomcat:8
docker.io/library/tomcat:8 #真实地址
<span class="hljs-meta">#</span><span class="bash">等价于</span>
docker pull tomcat:8
docker pull docker.io/library/tomcat:8</code></pre>
<pre><code class="hljs shell">pi@raspbian:~$ docker pull --help

Usage:  docker pull [OPTIONS] NAME[:TAG|@DIGEST]

Pull an image or a repository from a registry

Options:
  -a, --all-tags                Download all tagged images in the repository
      --disable-content-trust   Skip image verification (default true)
      --platform string         Set platform if server is multi-platform capable
  -q, --quiet                   Suppress verbose output</code></pre>
<p><strong>docker rmi 删除镜像</strong></p>
<pre><code class="hljs shell">docker rmi -f 镜像id #删除指定的镜像
docker rmi -f 镜像id 镜像id 镜像id 镜像id#删除指定的镜像
docker rmi -f $(docker images -aq) #删除全部的镜像</code></pre>
<p><strong>3.容器命令</strong></p>
<p>说明：我们有了镜像才可以创建容器，Linux，下载centos镜像来学习</p>
<pre><code class="hljs shell">docker run 镜像id 新建容器并启动
docker ps 列出所有运行的容器 docker container list
docker rm 容器id 删除指定容器
docker start 容器id #启动容器
docker restart容器id #重启容器
docker stop 容器id #停止当前正在运行的容器
docker kill 容器id #强制停止当前容器</code></pre>
<pre><code class="hljs shell">pi@raspbian:~$ docker container --help

Usage:  docker container COMMAND

Manage containers

Commands:
  attach      Attach local standard input, output, and error streams to a running container
  commit      Create a new image from a container&#x27;s changes
  cp          Copy files/folders between a container and the local filesystem
  create      Create a new container
  diff        Inspect changes to files or directories on a container&#x27;s filesystem
  exec        Run a command in a running container
  export      Export a container&#x27;s filesystem as a tar archive
  inspect     Display detailed information on one or more containers
  kill        Kill one or more running containers
  logs        Fetch the logs of a container
  ls          List containers
  pause       Pause all processes within one or more containers
  port        List port mappings or a specific mapping for the container
  prune       Remove all stopped containers
  rename      Rename a container
  restart     Restart one or more containers
  rm          Remove one or more containers
  run         Run a command in a new container
  start       Start one or more stopped containers
  stats       Display a live stream of container(s) resource usage statistics
  stop        Stop one or more running containers
  top         Display the running processes of a container
  unpause     Unpause all processes within one or more containers
  update      Update configuration of one or more containers
  wait        Block until one or more containers stop, then print their exit codes

Run &#x27;docker container COMMAND --help&#x27; for more information on a command.</code></pre>
<p><strong>新建容器并启动</strong></p>
<pre><code class="hljs shell">docker run [可选参数] image | docker container run [可选参数] image
<span class="hljs-meta">#</span><span class="bash">参书说明</span>
--name=&quot;Name&quot; 容器名字 tomcat01 tomcat02 用来区分容器
-d 后台方式运行
-it 使用交互方式运行，进入容器查看内容
-p 指定容器的端口 -p 8080(宿主机):8080(容器)
-p ip:主机端口:容器端口
-p 主机端口:容器端口(常用)
-p 容器端口
容器端口
-P(大写) 随机指定端口</code></pre>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 测试、启动并进入容器</span>
pi@raspbian:~$ docker run -it centos /bin/bash
Unable to find image &#x27;centos:latest&#x27; locally
latest: Pulling from library/centos
latest: Pulling from library/centos
333cbcae3fb8: Already exists 
Digest: sha256:5528e8b1b1719d34604c87e11dcd1c0a20bedf46e83b5632cdeac91b8c04efc1
Status: Downloaded newer image for centos:latest
[root@0c96b8cf9bc2 /]# ls
bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var
[root@0c96b8cf9bc2 /]#  exit #从容器退回主机
exit
pi@raspbian:~$ ls
 com.oray.sunlogin.client_10.0.2.24779_arm64.deb   pifan_win10_vm   Wallpapers  &#x27;学习强国-raspberrypi &#x27;   视频
 git                                               SunloginRemote   下载         文档                     软件
 libary                                            ThunderNetwork   公共         桌面                     音乐
 Miniconda3-latest-Linux-armv7l.sh                 tmp.text         图片         模板
pi@raspbian:~$</code></pre>
<p><strong>列出所有运行的容器</strong></p>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">docker ps命令 <span class="hljs-comment">#列出当前正在运行的容器</span></span>
-a, --all Show all containers (default shows just running)
-n, --last int Show n last created containers (includes all states)
(default -1)
-q, --quiet Only display numeric IDs</code></pre>
<pre><code class="hljs shell">pi@raspbian:~$ docker ps
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
pi@raspbian:~$ docker ps -a
CONTAINER ID   IMAGE          COMMAND                  CREATED          STATUS                          PORTS     NAMES
0c96b8cf9bc2   centos         &quot;/bin/bash&quot;              3 minutes ago    Exited (0) About a minute ago             nervous_albattani
09bcaba4de1f   hello-world    &quot;/hello&quot;                 40 minutes ago   Exited (0) 40 minutes ago                 brave_khayyam
0eaf062ca9fb   e86f991e5d10   &quot;/docker-entrypoint.…&quot;   5 days ago       Exited (0) 5 days ago                     nginx-test
f31980e0ab6a   e86f991e5d10   &quot;/docker-entrypoint.…&quot;   5 days ago       Exited (0) 5 days ago                     agitated_merkle
792d5e8c7575   e86f991e5d10   &quot;/docker-entrypoint.…&quot;   5 days ago       Exited (0) 5 days ago                     charming_galois
5d4de87f016f   centos         &quot;/bin/bash&quot;              5 days ago       Exited (0) 5 days ago                     suspicious_johnson
76bd27490955   hello-world    &quot;/hello&quot;                 5 days ago       Exited (0) 5 days ago                     funny_khayyam
pi@raspbian:~$ docker ps -aq
0c96b8cf9bc2
09bcaba4de1f
0eaf062ca9fb
f31980e0ab6a
792d5e8c7575
5d4de87f016f
76bd27490955</code></pre>
<p><strong>退出容器</strong></p>
<pre><code class="hljs shell">exit #容器直接退出
ctrl +P +Q #容器不停止退出</code></pre>
<p><strong>删除容器</strong></p>
<pre><code class="hljs shell">docker rm 容器id #删除指定的容器，不能删除正在运行的容器，如果要强制删除 rm -rf
docker rm -f $(docker ps -aq) #删除指定的容器
docker ps -a -q|xargs docker rm #删除所有的容器</code></pre>
<p><strong>启动和停止容器的操作</strong></p>
<pre><code class="hljs shell">docker start 容器id #启动容器
docker restart 容器id #重启容器
docker stop 容器id #停止当前正在运行的容器
docker kill 容器id #强制停止当前容器</code></pre>
<p><strong>4.常用其他命令</strong></p>
<p><strong>后台启动命令</strong></p>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 命令 docker run -d 镜像名</span></code></pre>
<pre><code class="hljs shell">pi@raspbian:~$ docker run -d centos
e6b768a79f51e29c9a8ef5379abc7a273c706a2550f771fd4dd4c744dd247fb2
pi@raspbian:~$ docker ps
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</code></pre>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 问题docker ps. 发现centos 停止了</span>
<span class="hljs-meta">#</span><span class="bash"> 退出原因</span>
<span class="hljs-meta">#</span><span class="bash"> 1、docker容器运行必须有一个前台进程， 如果没有前台进程执行，容器认为空闲，就会自行退出</span>
<span class="hljs-meta">#</span><span class="bash"> 2、容器运行的命令如果不是那些一直挂起的命令（ 运行top，tail、循环等），就是会自动退出</span>
<span class="hljs-meta">#</span><span class="bash"> 3、这个是 docker 的机制问题</span>
<span class="hljs-meta">#</span><span class="bash"> nginx，容器启动后，发现自己没有提供服务，就会立刻停止，就是没有程序了</span></code></pre>
<p><strong>查看日志</strong></p>
<pre><code class="hljs shell">docker logs --help
Options:
--details Show extra details provided to logs
* -f, --follow Follow log output
--since string Show logs since timestamp (e.g. 2013-01-02T13:23:37) or
relative (e.g. 42m for 42 minutes)
* --tail string Number of lines to show from the end of the logs
(default &quot;all&quot;)
* -t, --timestamps Show timestamps
--until string Show logs before a timestamp (e.g. 2013-01-02T13:23:37)
or relative (e.g. 42m for 42 minutes)</code></pre>
<pre><code class="hljs shell">pi@raspbian:~$ docker run -d centos /bin/sh -c &quot;while true;do echo 6666;sleep 1;done&quot;
f4311e01d77805cd82e583a75cf96e117fac719cf64ace3919158b9f6e3f8f5f
<span class="hljs-meta">#</span><span class="bash">模拟日志</span>
<span class="hljs-meta">#</span><span class="bash">显示日志</span>
-tf #显示日志信息（一直更新）
--tail number #需要显示日志条数
docker logs -t --tail n 容器id #查看n行日志
docker logs -ft 容器id #跟着日志</code></pre>
<p><strong>查看容器中进程信息 ps</strong></p>
<pre><code class="hljs shell">docker top 容器id</code></pre>
<pre><code class="hljs shell">pi@raspbian:~$ docker ps
CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS         PORTS     NAMES
f4311e01d778   centos    &quot;/bin/sh -c &#x27;while t…&quot;   9 seconds ago   Up 5 seconds             trusting_curie
pi@raspbian:~$ docker top f4311e01d778
UID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD
root                30484               30450               0                   22:25               ?                   00:00:00            /bin/sh -c while true;do echo 6666;sleep 1;done
root                32658               30484               0                   22:27               ?                   00:00:00            /usr/bin/coreutils --coreutils-prog-shebang=sleep /usr/bin/sleep 1</code></pre>
<p><strong>查看镜像的元数据</strong></p>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 命令</span>
docker inspect 容器id</code></pre>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">测试</span>
pi@raspbian:~$ docker inspect f4311e01d778
[
    &#123;
        &quot;Id&quot;: &quot;f4311e01d77805cd82e583a75cf96e117fac719cf64ace3919158b9f6e3f8f5f&quot;,
        &quot;Created&quot;: &quot;2021-01-17T14:25:35.710610691Z&quot;,
        &quot;Path&quot;: &quot;/bin/sh&quot;,
        &quot;Args&quot;: [
            &quot;-c&quot;,
            &quot;while true;do echo 6666;sleep 1;done&quot;
        ],
        &quot;State&quot;: &#123;
            &quot;Status&quot;: &quot;running&quot;,
            &quot;Running&quot;: true,
            &quot;Paused&quot;: false,
            &quot;Restarting&quot;: false,
            &quot;OOMKilled&quot;: false,
            &quot;Dead&quot;: false,
            &quot;Pid&quot;: 30484,
            &quot;ExitCode&quot;: 0,
            &quot;Error&quot;: &quot;&quot;,
            &quot;StartedAt&quot;: &quot;2021-01-17T14:25:38.846444708Z&quot;,
            &quot;FinishedAt&quot;: &quot;0001-01-01T00:00:00Z&quot;
        &#125;,
        &quot;Image&quot;: &quot;sha256:a0477e85b8aebf57d58bfa74a6598eccfd3fcc43a78c8e29c380cde2e7300a1b&quot;,
        &quot;ResolvConfPath&quot;: &quot;/var/lib/docker/containers/f4311e01d77805cd82e583a75cf96e117fac719cf64ace3919158b9f6e3f8f5f/resolv.conf&quot;,
        &quot;HostnamePath&quot;: &quot;/var/lib/docker/containers/f4311e01d77805cd82e583a75cf96e117fac719cf64ace3919158b9f6e3f8f5f/hostname&quot;,
        &quot;HostsPath&quot;: &quot;/var/lib/docker/containers/f4311e01d77805cd82e583a75cf96e117fac719cf64ace3919158b9f6e3f8f5f/hosts&quot;,
        &quot;LogPath&quot;: &quot;/var/lib/docker/containers/f4311e01d77805cd82e583a75cf96e117fac719cf64ace3919158b9f6e3f8f5f/f4311e01d77805cd82e583a75cf96e117fac719cf64ace3919158b9f6e3f8f5f-json.log&quot;,
        &quot;Name&quot;: &quot;/trusting_curie&quot;,
        &quot;RestartCount&quot;: 0,
        &quot;Driver&quot;: &quot;overlay2&quot;,
        &quot;Platform&quot;: &quot;linux&quot;,
        &quot;MountLabel&quot;: &quot;&quot;,
        &quot;ProcessLabel&quot;: &quot;&quot;,
        &quot;AppArmorProfile&quot;: &quot;&quot;,
        &quot;ExecIDs&quot;: null,
        &quot;HostConfig&quot;: &#123;
            &quot;Binds&quot;: null,
            &quot;ContainerIDFile&quot;: &quot;&quot;,
            &quot;LogConfig&quot;: &#123;
                &quot;Type&quot;: &quot;json-file&quot;,
                &quot;Config&quot;: &#123;&#125;
            &#125;,
            &quot;NetworkMode&quot;: &quot;default&quot;,
            &quot;PortBindings&quot;: &#123;&#125;,
            &quot;RestartPolicy&quot;: &#123;
                &quot;Name&quot;: &quot;no&quot;,
                &quot;MaximumRetryCount&quot;: 0
            &#125;,
            &quot;AutoRemove&quot;: false,
            &quot;VolumeDriver&quot;: &quot;&quot;,
            &quot;VolumesFrom&quot;: null,
            &quot;CapAdd&quot;: null,
            &quot;CapDrop&quot;: null,
            &quot;CgroupnsMode&quot;: &quot;host&quot;,
            &quot;Dns&quot;: [],
            &quot;DnsOptions&quot;: [],
            &quot;DnsSearch&quot;: [],
            &quot;ExtraHosts&quot;: null,
            &quot;GroupAdd&quot;: null,
            &quot;IpcMode&quot;: &quot;private&quot;,
            &quot;Cgroup&quot;: &quot;&quot;,
            &quot;Links&quot;: null,
            &quot;OomScoreAdj&quot;: 0,
            &quot;PidMode&quot;: &quot;&quot;,
            &quot;Privileged&quot;: false,
            &quot;PublishAllPorts&quot;: false,
            &quot;ReadonlyRootfs&quot;: false,
            &quot;SecurityOpt&quot;: null,
            &quot;UTSMode&quot;: &quot;&quot;,
            &quot;UsernsMode&quot;: &quot;&quot;,
            &quot;ShmSize&quot;: 67108864,
            &quot;Runtime&quot;: &quot;runc&quot;,
            &quot;ConsoleSize&quot;: [
                0,
                0
            ],
            &quot;Isolation&quot;: &quot;&quot;,
            &quot;CpuShares&quot;: 0,
            &quot;Memory&quot;: 0,
            &quot;NanoCpus&quot;: 0,
            &quot;CgroupParent&quot;: &quot;&quot;,
            &quot;BlkioWeight&quot;: 0,
            &quot;BlkioWeightDevice&quot;: [],
            &quot;BlkioDeviceReadBps&quot;: null,
            &quot;BlkioDeviceWriteBps&quot;: null,
            &quot;BlkioDeviceReadIOps&quot;: null,
            &quot;BlkioDeviceWriteIOps&quot;: null,
            &quot;CpuPeriod&quot;: 0,
            &quot;CpuQuota&quot;: 0,
            &quot;CpuRealtimePeriod&quot;: 0,
            &quot;CpuRealtimeRuntime&quot;: 0,
            &quot;CpusetCpus&quot;: &quot;&quot;,
            &quot;CpusetMems&quot;: &quot;&quot;,
            &quot;Devices&quot;: [],
            &quot;DeviceCgroupRules&quot;: null,
            &quot;DeviceRequests&quot;: null,
            &quot;KernelMemory&quot;: 0,
            &quot;KernelMemoryTCP&quot;: 0,
            &quot;MemoryReservation&quot;: 0,
            &quot;MemorySwap&quot;: 0,
            &quot;MemorySwappiness&quot;: null,
            &quot;OomKillDisable&quot;: false,
            &quot;PidsLimit&quot;: null,
            &quot;Ulimits&quot;: null,
            &quot;CpuCount&quot;: 0,
            &quot;CpuPercent&quot;: 0,
            &quot;IOMaximumIOps&quot;: 0,
            &quot;IOMaximumBandwidth&quot;: 0,
            &quot;MaskedPaths&quot;: [
                &quot;/proc/asound&quot;,
                &quot;/proc/acpi&quot;,
                &quot;/proc/kcore&quot;,
                &quot;/proc/keys&quot;,
                &quot;/proc/latency_stats&quot;,
                &quot;/proc/timer_list&quot;,
                &quot;/proc/timer_stats&quot;,
                &quot;/proc/sched_debug&quot;,
                &quot;/proc/scsi&quot;,
                &quot;/sys/firmware&quot;
            ],
            &quot;ReadonlyPaths&quot;: [
                &quot;/proc/bus&quot;,
                &quot;/proc/fs&quot;,
                &quot;/proc/irq&quot;,
                &quot;/proc/sys&quot;,
                &quot;/proc/sysrq-trigger&quot;
            ]
        &#125;,
        &quot;GraphDriver&quot;: &#123;
            &quot;Data&quot;: &#123;
                &quot;LowerDir&quot;: &quot;/var/lib/docker/overlay2/f3f69aeb9705b9bc24f209af81cc90657c4c2eee115d3c9d53fd0c67dc661d9d-init/diff:/var/lib/docker/overlay2/c59748945340c6610a4112c42f1f9929a4a1f5b8ae5ab50084cbc3ad12951286/diff&quot;,
                &quot;MergedDir&quot;: &quot;/var/lib/docker/overlay2/f3f69aeb9705b9bc24f209af81cc90657c4c2eee115d3c9d53fd0c67dc661d9d/merged&quot;,
                &quot;UpperDir&quot;: &quot;/var/lib/docker/overlay2/f3f69aeb9705b9bc24f209af81cc90657c4c2eee115d3c9d53fd0c67dc661d9d/diff&quot;,
                &quot;WorkDir&quot;: &quot;/var/lib/docker/overlay2/f3f69aeb9705b9bc24f209af81cc90657c4c2eee115d3c9d53fd0c67dc661d9d/work&quot;
            &#125;,
            &quot;Name&quot;: &quot;overlay2&quot;
        &#125;,
        &quot;Mounts&quot;: [],
        &quot;Config&quot;: &#123;
            &quot;Hostname&quot;: &quot;f4311e01d778&quot;,
            &quot;Domainname&quot;: &quot;&quot;,
            &quot;User&quot;: &quot;&quot;,
            &quot;AttachStdin&quot;: false,
            &quot;AttachStdout&quot;: false,
            &quot;AttachStderr&quot;: false,
            &quot;Tty&quot;: false,
            &quot;OpenStdin&quot;: false,
            &quot;StdinOnce&quot;: false,
            &quot;Env&quot;: [
                &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;
            ],
            &quot;Cmd&quot;: [
                &quot;/bin/sh&quot;,
                &quot;-c&quot;,
                &quot;while true;do echo 6666;sleep 1;done&quot;
            ],
            &quot;Image&quot;: &quot;centos&quot;,
            &quot;Volumes&quot;: null,
            &quot;WorkingDir&quot;: &quot;&quot;,
            &quot;Entrypoint&quot;: null,
            &quot;OnBuild&quot;: null,
            &quot;Labels&quot;: &#123;
                &quot;org.label-schema.build-date&quot;: &quot;20201204&quot;,
                &quot;org.label-schema.license&quot;: &quot;GPLv2&quot;,
                &quot;org.label-schema.name&quot;: &quot;CentOS Base Image&quot;,
                &quot;org.label-schema.schema-version&quot;: &quot;1.0&quot;,
                &quot;org.label-schema.vendor&quot;: &quot;CentOS&quot;
            &#125;
        &#125;,
        &quot;NetworkSettings&quot;: &#123;
            &quot;Bridge&quot;: &quot;&quot;,
            &quot;SandboxID&quot;: &quot;5d580bec850d90d77a2f36592b1d15d4e56acbb7065320914677090968726a7b&quot;,
            &quot;HairpinMode&quot;: false,
            &quot;LinkLocalIPv6Address&quot;: &quot;&quot;,
            &quot;LinkLocalIPv6PrefixLen&quot;: 0,
            &quot;Ports&quot;: &#123;&#125;,
            &quot;SandboxKey&quot;: &quot;/var/run/docker/netns/5d580bec850d&quot;,
            &quot;SecondaryIPAddresses&quot;: null,
            &quot;SecondaryIPv6Addresses&quot;: null,
            &quot;EndpointID&quot;: &quot;6d7d115f815c56f29df5333be2296a0cfbb541227396fad448bca0f711e5ca9b&quot;,
            &quot;Gateway&quot;: &quot;172.17.0.1&quot;,
            &quot;GlobalIPv6Address&quot;: &quot;&quot;,
            &quot;GlobalIPv6PrefixLen&quot;: 0,
            &quot;IPAddress&quot;: &quot;172.17.0.2&quot;,
            &quot;IPPrefixLen&quot;: 16,
            &quot;IPv6Gateway&quot;: &quot;&quot;,
            &quot;MacAddress&quot;: &quot;02:42:ac:11:00:02&quot;,
            &quot;Networks&quot;: &#123;
                &quot;bridge&quot;: &#123;
                    &quot;IPAMConfig&quot;: null,
                    &quot;Links&quot;: null,
                    &quot;Aliases&quot;: null,
                    &quot;NetworkID&quot;: &quot;33604500820e5692b82d7a1fff29f5f6586d572f6db2aef1440d0237a81a2b1e&quot;,
                    &quot;EndpointID&quot;: &quot;6d7d115f815c56f29df5333be2296a0cfbb541227396fad448bca0f711e5ca9b&quot;,
                    &quot;Gateway&quot;: &quot;172.17.0.1&quot;,
                    &quot;IPAddress&quot;: &quot;172.17.0.2&quot;,
                    &quot;IPPrefixLen&quot;: 16,
                    &quot;IPv6Gateway&quot;: &quot;&quot;,
                    &quot;GlobalIPv6Address&quot;: &quot;&quot;,
                    &quot;GlobalIPv6PrefixLen&quot;: 0,
                    &quot;MacAddress&quot;: &quot;02:42:ac:11:00:02&quot;,
                    &quot;DriverOpts&quot;: null
                &#125;
            &#125;
        &#125;
    &#125;
]</code></pre>
<p><strong>进入当前正在运行的容器</strong></p>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 我们通常容器都是使用后台方式运行的，需要进入容器，修改一些配置</span>
<span class="hljs-meta">#</span><span class="bash"> 命令</span>
docker exec -it 容器id bin/bash
<span class="hljs-meta">#</span><span class="bash">测试</span>
pi@raspbian:~$ docker exec -it f4311e01d778 bin/bash
[root@f4311e01d778 /]# ps
  PID TTY          TIME CMD
  368 pts/0    00:00:00 bash
  396 pts/0    00:00:00 ps
[root@f4311e01d778 /]# exit
exit</code></pre>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 方式二</span>
docker attach 容器id
<span class="hljs-meta">#</span><span class="bash">测试</span>
pi@raspbian:~$ docker attach f4311e01d778
6666
6666
6666
6666
6666
6666
……</code></pre>
<pre><code class="hljs shell">区别
<span class="hljs-meta">#</span><span class="bash">docker <span class="hljs-built_in">exec</span> <span class="hljs-comment">#进入当前容器后开启一个新的终端，可以在里面操作。（常用）</span></span>
<span class="hljs-meta">#</span><span class="bash">docker attach <span class="hljs-comment"># 进入容器正在执行的终端</span></span></code></pre>
<p><strong>从容器内拷贝到主机上</strong></p>
<pre><code class="hljs shell">docker cp 容器id:容器内路径 主机目的路径
<span class="hljs-meta">#</span><span class="bash">进入docker容器内部</span></code></pre>
<pre><code class="hljs shell">pi@raspbian:~$ docker ps
CONTAINER ID   IMAGE     COMMAND       CREATED         STATUS         PORTS     NAMES
e7c4a115ff36   centos    &quot;/bin/bash&quot;   2 minutes ago   Up 2 minutes             awesome_tereshkova
pi@raspbian:~$ docker exec -it e7c4a115ff36  /bin/bash
[root@e7c4a115ff36 /]# cd
[root@e7c4a115ff36 ~]# ls
anaconda-ks.cfg  anaconda-post.log  original-ks.cfg
[root@e7c4a115ff36 ~]#  touch zsh
[root@e7c4a115ff36 ~]# echo &quot;shadiao&quot; &gt; zsh      
[root@e7c4a115ff36 ~]# cat zsh
shadiao
[root@e7c4a115ff36 ~]# docker cp e7c4a115ff36:~/zsh /
bash: docker: command not found
[root@e7c4a115ff36 ~]# pwd
/root
[root@e7c4a115ff36 ~]# 
pi@raspbian:~$ docker cp e7c4a115ff36:/root/zsh /home/pi
pi@raspbian:~$ ls
 com.oray.sunlogin.client_10.0.2.24779_arm64.deb   pifan_win10_vm   Wallpapers   图片                     模板
 git                                               SunloginRemote   zsh         &#x27;学习强国-raspberrypi &#x27;   视频
 libary                                            ThunderNetwork   下载         文档                     软件
 Miniconda3-latest-Linux-armv7l.sh                 tmp.text         公共         桌面                     音乐
pi@raspbian:~$ cat zsh
shadiao</code></pre>
<p>学习方式：将所有笔记敲一遍，自己记录笔记！</p>
<h2 id="四、小结"><a href="#四、小结" class="headerlink" title="四、小结"></a>四、小结</h2><p><strong>Docker的所有命令</strong></p>
<p><img src="https://gitee.com/bai_xiao_fei/picture/raw/master/PicGo/01190232_02Qb.png" srcset="/img/loading.gif" alt=""></p>
<p><strong>Docker命令帮助文档（重要）</strong></p>
<pre><code class="hljs shell">attach Attach local standard input, output, and error streams to a
running container
<span class="hljs-meta">#</span><span class="bash">当前shell下 attach连接指定运行的镜像</span>
build Build an image from a Dockerfile # 通过Dockerfile定制镜像
commit Create a new image from a container&#x27;s changes #提交当前容器为新的镜像
cp Copy files/folders between a container and the local filesystem #拷贝文件
create Create a new container #创建一个新的容器
diff Inspect changes to files or directories on a container&#x27;s
filesystem #查看docker容器的变化
events Get real time events from the server # 从服务获取容器实时时间
exec Run a command in a running container # 在运行中的容器上运行命令
export Export a container&#x27;s filesystem as a tar archive #导出容器文件系统作
为一个tar归档文件[对应import]
history Show the history of an image # 展示一个镜像形成历史
images List images #列出系统当前的镜像
import Import the contents from a tarball to create a filesystem image #
从tar包中导入内容创建一个文件系统镜像
info Display system-wide information # 显示全系统信息
inspect Return low-level information on Docker objects #查看容器详细信息
kill Kill one or more running containers # kill指定docker容器
load Load an image from a tar archive or STDIN #从一个tar包或标准输入中加载
一个镜像[对应save]
login Log in to a Docker registry #
logout Log out from a Docker registry
logs Fetch the logs of a container
pause Pause all processes within one or more containers
port List port mappings or a specific mapping for the container
ps List containers
pull Pull an image or a repository from a registry
push Push an image or a repository to a registry
rename Rename a container
restart Restart one or more containers
rm Remove one or more containers
rmi Remove one or more images
run Run a command in a new container
save Save one or more images to a tar archive (streamed to STDOUT by
default)
search Search the Docker Hub for images
start Start one or more stopped containers
stats Display a live stream of container(s) resource usage statistics
stop Stop one or more running containers
tag Create a tag TARGET_IMAGE that refers to SOURCE_IMAGE
top Display the running processes of a container
unpause Unpause all processes within one or more containers
update Update configuration of one or more containers
version Show the Docker version information
wait Block until one or more containers stop, then print their exit
codes</code></pre>
<h2 id="作业练习"><a href="#作业练习" class="headerlink" title="作业练习"></a>作业练习</h2><p>三个作业：作业1告诉我们暴露端口的重要性；作业2告诉我们进入容器的重要性；作业3告诉我们查看当前容器状态的重要性，如何修改容器运行的环境。</p>
<p><strong>作业1：Docker 安装Nginx</strong></p>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">1. 搜索镜像 search 建议大家去docker搜索，可以看到帮助文档</span>
<span class="hljs-meta">#</span><span class="bash">2. 拉取镜像 pull</span>
<span class="hljs-meta">#</span><span class="bash">3. 运行测试</span>
<span class="hljs-meta">#</span><span class="bash"> -d 后台运行</span>
<span class="hljs-meta">#</span><span class="bash"> --name 给容器命名</span>
<span class="hljs-meta">#</span><span class="bash"> -p 宿主机端口：容器内部端口</span></code></pre>
<pre><code class="hljs shell">pi@raspbian:~$ docker search -f  stars=5000 nginx
NAME      DESCRIPTION                STARS     OFFICIAL   AUTOMATED
nginx     Official build of Nginx.   14291     [OK] 
pi@raspbian:~$ docker pull nginx
Using default tag: latest
latest: Pulling from library/nginx
f8be76fcf206: Pull complete 
56d3a31c1999: Pull complete 
61e3132252c9: Pull complete 
703916d761e9: Pull complete 
53e819da52d9: Pull complete 
Digest: sha256:10b8cc432d56da8b61b070f4c7d2543a9ed17c2b23010b43af434fd40e2ca4aa
Status: Downloaded newer image for nginx:latest
docker.io/library/nginx:latest
pi@raspbian:~$ docker run -d --name nginx01 -p 8088:80 nginx
c86f35254ea1c2abad877c4942217d55d7e582b382a2510e6d4a5ac8b1118f0c
pi@raspbian:~$ curl localhost:8088
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Welcome to nginx!&lt;/title&gt;
&lt;style&gt;
    body &#123;
        width: 35em;
        margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif;
    &#125;
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
&lt;p&gt;If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.&lt;/p&gt;

&lt;p&gt;For online documentation and support please refer to
&lt;a href=&quot;http://nginx.org/&quot;&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;
Commercial support is available at
&lt;a href=&quot;http://nginx.com/&quot;&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p><img src="https://gitee.com/bai_xiao_fei/picture/raw/master/PicGo/QQ%E6%88%AA%E5%9B%BE20210117230259.png" srcset="/img/loading.gif" alt=""></p>
<p><strong>端口暴露示意图：</strong></p>
<p><img src="https://gitee.com/bai_xiao_fei/picture/raw/master/PicGo/QQ%E6%88%AA%E5%9B%BE20210117230043.png" srcset="/img/loading.gif" alt=""></p>
<p><strong>思考问题</strong>：我们每次改动nginx配置文件，都需要进入容器内部？十分的麻烦，要是可以在容器外部提供一个映射路径，达到在容器修改文件名，容器内部就可以自动修改？→ 数据卷！</p>
<p><strong>作业2：docker 来装一个tomcat</strong></p>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 官方的使用</span>
docker run -it --rm tomcat:9.0
<span class="hljs-meta">#</span><span class="bash"> 之前的启动都是后台，停止了容器，容器还是可以查到</span>
<span class="hljs-meta">#</span><span class="bash"> docker run -it --rm image 一般是用来测试，用完就删除（暂时不建议）</span>
--rm Automatically remove the container when it exits
<span class="hljs-meta">#</span><span class="bash">下载</span>
docker pull tomcat
<span class="hljs-meta">#</span><span class="bash">启动运行</span>
docker run -d -p 8080:8080 --name tomcat01 tomcat
<span class="hljs-meta">#</span><span class="bash">测试访问有没有问题</span>
curl localhost:8080
<span class="hljs-meta">#</span><span class="bash">进入容器</span>
➜ ~ docker ps
CONTAINER ID IMAGE COMMAND CREATED
STATUS PORTS NAMES
db09851cf82e tomcat &quot;catalina.sh run&quot; 28 seconds ago
Up 27 seconds 0.0.0.0:8080-&gt;8080/tcp tomcat01
➜ ~ docker exec -it db09851cf82e /bin/bash
root@db09851cf82e:/usr/local/tomcat#
<span class="hljs-meta">#</span><span class="bash"> 发现问题：1、linux命令少了。 2.没有webapps</span>
<span class="hljs-meta">#</span><span class="bash"> 阿里云镜像（阉割版），它为保证最小镜像，将不必要的都剔除了→保证最小可运行环境！</span></code></pre>
<p><strong>思考问题</strong>：我们以后要部署项目，如果每次都要进入容器是不是十分麻烦？要是可以在容器外部提供一个映射路径，webapps，我们在外部放置项目，就自动同步内部就好了！</p>
<p><strong>作业3：部署es+kibana</strong></p>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> es 暴露的端口很多！</span>
<span class="hljs-meta">#</span><span class="bash"> es 十分耗内存</span>
<span class="hljs-meta">#</span><span class="bash"> es 的数据一般需要放置到安全目录！挂载</span>
<span class="hljs-meta">#</span><span class="bash"> --net somenetwork ? 网络配置</span>
<span class="hljs-meta">#</span><span class="bash"> 下载启动elasticsearch（Docker一步搞定）</span>
docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e
&quot;discovery.type=single-node&quot; elasticsearch:7.6.2
<span class="hljs-meta">#</span><span class="bash"> 测试一下es是否成功启动</span>
➜ ~ curl localhost:9200
&#123;
&quot;name&quot; : &quot;d73ad2f22dd3&quot;,
&quot;cluster_name&quot; : &quot;docker-cluster&quot;,
&quot;cluster_uuid&quot; : &quot;atFKgANxS8CzgIyCB8PGxA&quot;,
&quot;version&quot; : &#123;
&quot;number&quot; : &quot;7.6.2&quot;,
&quot;build_flavor&quot; : &quot;default&quot;,
&quot;build_type&quot; : &quot;docker&quot;,
&quot;build_hash&quot; : &quot;ef48eb35cf30adf4db14086e8aabd07ef6fb113f&quot;,
&quot;build_date&quot; : &quot;2020-03-26T06:34:37.794943Z&quot;,
&quot;build_snapshot&quot; : false,
&quot;lucene_version&quot; : &quot;8.4.0&quot;,
&quot;minimum_wire_compatibility_version&quot; : &quot;6.8.0&quot;,
&quot;minimum_index_compatibility_version&quot; : &quot;6.0.0-beta1&quot;
&#125;,
&quot;tagline&quot; : &quot;You Know, for Search&quot;
&#125;
<span class="hljs-meta">#</span><span class="bash"> 查看docker容器使用内存情况（每秒刷新，也挺耗内存的一个命令）</span>
➜ ~ docker stats
<span class="hljs-meta">#</span><span class="bash">关闭，添加内存的限制，修改配置文件 -e 环境配置修改</span>
➜ ~ docker rm -f d73ad2f22dd3
➜ ~ docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e
&quot;discovery.type=single-node&quot; -e ES_JAVA_OPTS=&quot;-Xms64m -Xmx512m&quot;
elasticsearch:7.6.2</code></pre>
<pre><code class="hljs shell">➜ ~ curl localhost:9200
&#123;
&quot;name&quot; : &quot;b72c9847ec48&quot;,
&quot;cluster_name&quot; : &quot;docker-cluster&quot;,
&quot;cluster_uuid&quot; : &quot;yNAK0EORSvq3Wtaqe2QqAg&quot;,
&quot;version&quot; : &#123;
&quot;number&quot; : &quot;7.6.2&quot;,
&quot;build_flavor&quot; : &quot;default&quot;,
&quot;build_type&quot; : &quot;docker&quot;,
&quot;build_hash&quot; : &quot;ef48eb35cf30adf4db14086e8aabd07ef6fb113f&quot;,
&quot;build_date&quot; : &quot;2020-03-26T06:34:37.794943Z&quot;,
&quot;build_snapshot&quot; : false,
&quot;lucene_version&quot; : &quot;8.4.0&quot;,
&quot;minimum_wire_compatibility_version&quot; : &quot;6.8.0&quot;,
&quot;minimum_index_compatibility_version&quot; : &quot;6.0.0-beta1&quot;
&#125;,
&quot;tagline&quot; : &quot;You Know, for Search&quot;
&#125;</code></pre>
<p>作业：使用kibana连接es？思考网络如何才能连接。</p>
<h2 id="五、Docker可视化"><a href="#五、Docker可视化" class="headerlink" title="五、Docker可视化"></a>五、Docker可视化</h2><p><strong>什么是portainer？</strong></p>
<p>Docker图形化界面管理工具！提供一个后台面板供我们操作！</p>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 运行如下命令即可 打开可视化服务</span>
docker run -d -p 8080:9000 \
--restart=always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer</code></pre>
<p>访问：<a target="_blank" rel="noopener" href="http://ip:8080/">http://ip:8080/</a></p>
<p><img src="https://gitee.com/bai_xiao_fei/picture/raw/master/PicGo/1732557-20200612151233073-1381095621.png" srcset="/img/loading.gif" alt=""><br><img src="https://gitee.com/bai_xiao_fei/picture/raw/master/PicGo/1732557-20200612151250198-1149603218.png" srcset="/img/loading.gif" alt=""><br><img src="https://gitee.com/bai_xiao_fei/picture/raw/master/PicGo/1732557-20200612151312879-18447650.png" srcset="/img/loading.gif" alt=""><br><img src="https://gitee.com/bai_xiao_fei/picture/raw/master/PicGo/1732557-20200612151331571-58946069.png" srcset="/img/loading.gif" alt=""></p>
<h2 id="六、Docker镜像讲解"><a href="#六、Docker镜像讲解" class="headerlink" title="六、Docker镜像讲解"></a>六、Docker镜像讲解</h2><p><strong>镜像是什么</strong></p>
<h3 id="Docker镜像加载原理"><a href="#Docker镜像加载原理" class="headerlink" title="Docker镜像加载原理"></a>Docker镜像加载原理</h3><p>镜像是一种轻量级、可执行的独立软件保，用来打包软件运行环境和基于运行环境开发的软件，他包含运行某个软件所需的所有内容，包括<strong>代码、运行时库、环境变量和配置文件</strong>。<br>将所有的应用和环境，直接打包为docker镜像，就可以直接运行。</p>
<ul>
<li>UnionFs （联合文件系统）</li>
</ul>
<p>我们下载的时候看到一层层的下载就是这个。</p>
<blockquote>
<p>UnionFs（联合文件系统）：Union文件系统（UnionFs）是一种分层、轻量级并且高性能的文件系统，他支持对文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂载到同一个虚拟文件系统下（unite several directories into a single virtual filesystem)。Union文件系统是Docker镜像的基础。镜像可以通过分层来进行继承，基于基础镜像（没有父镜像），可以制作各种具体的应用镜像。</p>
<p><strong>特性</strong>：一次同时加载多个文件系统，但从外面看起来，只能看到一个文件系统，联合加载会把各层文件系统叠加起来，这样最终的文件系统会包含所有底层的文件和目录。</p>
</blockquote>
<ul>
<li>Docker镜像加载原理</li>
</ul>
<p>docker的镜像实际上由一层一层的文件系统组成，这种层级的文件系统UnionFS。</p>
<blockquote>
<p>boots(boot file system）主要包含 bootloader和 Kernel, bootloader主要是引导加 kernel,<br>Linux刚启动时会加bootfs文件系统，在 Docker镜像的最底层是 boots。这一层与我们典型的Linux/Unix系统是一样的，包含boot加載器和内核。当boot加载完成之后整个内核就都在内存中了，此时内存的使用权已由 bootfs转交给内核，此时系统也会卸载bootfs。</p>
<p>rootfs（root file system),在 bootfs之上。包含的就是典型 Linux系统的/dev,/proc,/bin,/etc等标准目录和文件。 rootfs就是各种不同的操作系统发行版，比如 Ubuntu,Centos等等。</p>
</blockquote>
<p><img src="https://gitee.com/bai_xiao_fei/picture/raw/master/PicGo/u=1739556097,893309826&amp;fm=15&amp;gp=0.jpg" srcset="/img/loading.gif" alt=""></p>
<p>平时我们安装进虚拟机的CentOS都是好几个G，为什么Docker这里才200M？</p>
<p><img src="https://gitee.com/bai_xiao_fei/picture/raw/master/PicGo/QQ%E6%88%AA%E5%9B%BE20210118112102.png" srcset="/img/loading.gif" alt=""></p>
<blockquote>
<p>对于个精简的OS,rootfs可以很小，只需要包合最基本的命令，工具和程序库就可以了，因为底层直接用Host的kernel，自己只需要提供rootfs就可以了。由此可见对于不同的Linux发行版， boots基本是一致的， rootfs会有差別，因此不同的发行版可以公用bootfs.</p>
<p>虚拟机是分钟级别，容器是秒级！</p>
</blockquote>
<h3 id="分层理解"><a href="#分层理解" class="headerlink" title="分层理解"></a>分层理解</h3><p>我们可以去下载一个镜像，注意观察下载的日志输出，可以看到是一层层的在下载 。</p>
<pre><code class="hljs shell">pi@raspbian:~$ docker pull redis
Using default tag: latest
latest: Pulling from library/redis
f8be76fcf206: Already exists 
10ca116bc5c3: Pull complete 
8aa044f70158: Pull complete 
c9ee276a1a0f: Pull complete 
8954c3738673: Pull complete 
082886f56848: Pull complete 
Digest: sha256:0f97c1c9daf5b69b93390ccbe8d3e2971617ec4801fd0882c72bf7cad3a13494
Status: Downloaded newer image for redis:latest
docker.io/library/redis:latest</code></pre>
<p><strong>思考：为什么Docker镜像要采用这种分层的结构呢？</strong></p>
<p>最大的好处，我觉得莫过于资源共享了！比如有多个镜像都从相同的Base镜像构建而来，那么宿主机只需在磁盘上保留一份base镜像，同时内存中也只需要加载一份base镜像，这样就可以为所有的容器服务了，而且镜像的每一层都可以被共享。</p>
<p><img src="https://gitee.com/bai_xiao_fei/picture/raw/master/PicGo/1222.png" srcset="/img/loading.gif" alt=""></p>
<p>查看镜像分层的方式可以通过<strong>docker image inspect </strong>命令</p>
<pre><code class="hljs shell">pi@raspbian:~$ docker image inspect redis
[
    &#123;
        &quot;Id&quot;: &quot;sha256:aab98baa141a5336da8748325b8ef41bb387276bc8215b32070f38c27de20733&quot;,
        &quot;RepoTags&quot;: [
            &quot;redis:latest&quot;
        ],
        &quot;RepoDigests&quot;: [
            &quot;redis@sha256:0f97c1c9daf5b69b93390ccbe8d3e2971617ec4801fd0882c72bf7cad3a13494&quot;
        ],
        &quot;Parent&quot;: &quot;&quot;,
        &quot;Comment&quot;: &quot;&quot;,
        &quot;Created&quot;: &quot;2021-01-13T06:05:21.619263128Z&quot;,
        &quot;Container&quot;: &quot;7c9310c3295be6022a73a546d41a7ad89fa09e8502ee43cc0d7df2c9681e2b44&quot;,
        &quot;ContainerConfig&quot;: &#123;
            &quot;Hostname&quot;: &quot;7c9310c3295b&quot;,
            &quot;Domainname&quot;: &quot;&quot;,
            &quot;User&quot;: &quot;&quot;,
            &quot;AttachStdin&quot;: false,
            &quot;AttachStdout&quot;: false,
            &quot;AttachStderr&quot;: false,
            &quot;ExposedPorts&quot;: &#123;
                &quot;6379/tcp&quot;: &#123;&#125;
            &#125;,
            &quot;Tty&quot;: false,
            &quot;OpenStdin&quot;: false,
            &quot;StdinOnce&quot;: false,
            &quot;Env&quot;: [
                &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;,
                &quot;GOSU_VERSION=1.12&quot;,
                &quot;REDIS_VERSION=6.0.10&quot;,
                &quot;REDIS_DOWNLOAD_URL=http://download.redis.io/releases/redis-6.0.10.tar.gz&quot;,
                &quot;REDIS_DOWNLOAD_SHA=79bbb894f9dceb33ca699ee3ca4a4e1228be7fb5547aeb2f99d921e86c1285bd&quot;
            ],
            &quot;Cmd&quot;: [
                &quot;/bin/sh&quot;,
                &quot;-c&quot;,
                &quot;#(nop) &quot;,
                &quot;CMD [\&quot;redis-server\&quot;]&quot;
            ],
            &quot;Image&quot;: &quot;sha256:047d03cf5cdd81af3dd04d9ca945f956afec58fab4028bbd4cf24f561eae8c20&quot;,
            &quot;Volumes&quot;: &#123;
                &quot;/data&quot;: &#123;&#125;
            &#125;,
            &quot;WorkingDir&quot;: &quot;/data&quot;,
            &quot;Entrypoint&quot;: [
                &quot;docker-entrypoint.sh&quot;
            ],
            &quot;OnBuild&quot;: null,
            &quot;Labels&quot;: &#123;&#125;
        &#125;,
        &quot;DockerVersion&quot;: &quot;19.03.12&quot;,
        &quot;Author&quot;: &quot;&quot;,
        &quot;Config&quot;: &#123;
            &quot;Hostname&quot;: &quot;&quot;,
            &quot;Domainname&quot;: &quot;&quot;,
            &quot;User&quot;: &quot;&quot;,
            &quot;AttachStdin&quot;: false,
            &quot;AttachStdout&quot;: false,
            &quot;AttachStderr&quot;: false,
            &quot;ExposedPorts&quot;: &#123;
                &quot;6379/tcp&quot;: &#123;&#125;
            &#125;,
            &quot;Tty&quot;: false,
            &quot;OpenStdin&quot;: false,
            &quot;StdinOnce&quot;: false,
            &quot;Env&quot;: [
                &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;,
                &quot;GOSU_VERSION=1.12&quot;,
                &quot;REDIS_VERSION=6.0.10&quot;,
                &quot;REDIS_DOWNLOAD_URL=http://download.redis.io/releases/redis-6.0.10.tar.gz&quot;,
                &quot;REDIS_DOWNLOAD_SHA=79bbb894f9dceb33ca699ee3ca4a4e1228be7fb5547aeb2f99d921e86c1285bd&quot;
            ],
            &quot;Cmd&quot;: [
                &quot;redis-server&quot;
            ],
            &quot;Image&quot;: &quot;sha256:047d03cf5cdd81af3dd04d9ca945f956afec58fab4028bbd4cf24f561eae8c20&quot;,
            &quot;Volumes&quot;: &#123;
                &quot;/data&quot;: &#123;&#125;
            &#125;,
            &quot;WorkingDir&quot;: &quot;/data&quot;,
            &quot;Entrypoint&quot;: [
                &quot;docker-entrypoint.sh&quot;
            ],
            &quot;OnBuild&quot;: null,
            &quot;Labels&quot;: null
        &#125;,
        &quot;Architecture&quot;: &quot;arm64&quot;,
        &quot;Os&quot;: &quot;linux&quot;,
        &quot;Size&quot;: 98563933,
        &quot;VirtualSize&quot;: 98563933,
        &quot;GraphDriver&quot;: &#123;
            &quot;Data&quot;: &#123;
                &quot;LowerDir&quot;: &quot;/var/lib/docker/overlay2/8956154e500c52ffc3685660afda4a8cc58237d452eacb0cebabab49ed0b8081/diff:/var/lib/docker/overlay2/957892645b91290509180c7f3619c89ea140ee71f38a9bb6b00098784f3ff640/diff:/var/lib/docker/overlay2/0ea446714060db67ba0c18c012a8234a3015314e1a73ed4a9f9963a0d3635063/diff:/var/lib/docker/overlay2/aa9cc057f7ae7bb7655396dbd69b9c7c22f3124695f1e8640a7554896e9ecd6a/diff:/var/lib/docker/overlay2/843fddc80540357e3e639e8cb7cccbb9512354b70cfe10cee3ed3123dbaed53a/diff&quot;,
                &quot;MergedDir&quot;: &quot;/var/lib/docker/overlay2/09b7e18ab5dd846f2c0c7a34930d87063daa356798e6716902bd98c8a96f1906/merged&quot;,
                &quot;UpperDir&quot;: &quot;/var/lib/docker/overlay2/09b7e18ab5dd846f2c0c7a34930d87063daa356798e6716902bd98c8a96f1906/diff&quot;,
                &quot;WorkDir&quot;: &quot;/var/lib/docker/overlay2/09b7e18ab5dd846f2c0c7a34930d87063daa356798e6716902bd98c8a96f1906/work&quot;
            &#125;,
            &quot;Name&quot;: &quot;overlay2&quot;
        &#125;,
        &quot;RootFS&quot;: &#123;
            &quot;Type&quot;: &quot;layers&quot;,
            &quot;Layers&quot;: [
                &quot;sha256:5c4f3d84264daaff85b2f005a4c295693e48c0e9c3ae76e64a7f3914e94e583b&quot;,
                &quot;sha256:3a812f593e11f6ad98eae74e75a9fe026265d913e9cddc2478e966169e6e9040&quot;,
                &quot;sha256:34ec83b8d3276d5396b2b987f169e3ee22c25c21a701c2228cb7cbcb09f33ee6&quot;,
                &quot;sha256:4bf30474a6f6b17a5aa86cd8578a8bbd1ab6507bb1ca0096498811647dc8accc&quot;,
                &quot;sha256:b195ac169cf01ef7e5342d1cdbe506123584bcf2a3c1da48401adf92c2dfaecd&quot;,
                &quot;sha256:693285e577b858ea1cd2ad86bfaca34eac441f2be427131c5e676ad3d69cb5ef&quot;
            ]
        &#125;,
        &quot;Metadata&quot;: &#123;
            &quot;LastTagTime&quot;: &quot;0001-01-01T00:00:00Z&quot;
        &#125;
    &#125;
]</code></pre>
<p><strong>理解：</strong></p>
<blockquote>
<p>所有的 Docker镜像都起始于一个基础镜像层，当进行修改或培加新的内容时，就会在当前镜像层之上，创建新的镜像层。</p>
<p>举一个简单的例子，假如基于 Ubuntu Linux16.04创建一个新的镜像，这就是新镜像的第一层；如果在该镜像中添加 Python包，就会在基础镜像层之上创建第二个镜像层；如果继续添加一个安全补丁，就会创健第三个镜像层该像当前已经包含3个镜像层，如下图所示（这只是一个用于演示的很简单的例子）。</p>
</blockquote>
<p><img src="https://gitee.com/bai_xiao_fei/picture/raw/master/PicGo/QQ%E6%88%AA%E5%9B%BE20210118113254.png" srcset="/img/loading.gif" alt=""></p>
<blockquote>
<p>在添加额外的镜像层的同时，镜像始终保持是当前所有镜像的组合，理解这一点非常重要。下图中举了一个简单的例子，每个镜像层包含3个文件，而镜像包含了来自两个镜像层的6个文件。</p>
</blockquote>
<p> <img src="https://gitee.com/bai_xiao_fei/picture/raw/master/PicGo/QQ%E6%88%AA%E5%9B%BE20210118113306.png" srcset="/img/loading.gif" alt=""></p>
<p>上图中的镜像层跟之前图中的略有区別，主要目的是便于展示文件。</p>
<p>下图中展示了一个稍微复杂的三层镜像，在外部看来整个镜像只有6个文件，这是因为最上层中的文件7是文件5的一个更新版。</p>
<p><img src="https://gitee.com/bai_xiao_fei/picture/raw/master/PicGo/QQ%E6%88%AA%E5%9B%BE20210118113519.png" srcset="/img/loading.gif" alt=""></p>
<p>这种情況下，上层镜像层中的文件覆盖了底层镜像层中的文件。这样就使得文件的更新版本作为一个新镜像层添加到镜像当中。</p>
<p>Docker通过存储引擎（新版本采用快照机制）的方式来实现镜像层堆栈，并保证多镜像层对外展示为统一的文件系统。</p>
<p>Linux上可用的存储引撃有AUFS、 Overlay2、 Device Mapper、Btrfs以及ZFS。顾名思义，每种存储引擎都基于 Linux中对应的文件系统或者块设备技术，井且每种存储引擎都有其独有的性能特点。</p>
<p>Docker在 Windows上仅支持 windowsfilter 一种存储引擎，该引擎基于NTFS文件系统之上实现了分层<br>和CoW [1]。</p>
<p>下图展示了与系统显示相同的三层镜像。所有镜像层堆并合井，对外提供统一的视图。</p>
<p><img src="https://gitee.com/bai_xiao_fei/picture/raw/master/PicGo/QQ%E6%88%AA%E5%9B%BE20210118115410.png" srcset="/img/loading.gif" alt=""></p>
<p><strong>特点</strong></p>
<p>Docker 镜像都是只读的，当容器启动时，一个新的可写层加载到镜像的顶部！</p>
<p>这一层就是我们通常说的容器层，容器之下的都叫镜像层！</p>
<p><img src="https://gitee.com/bai_xiao_fei/picture/raw/master/PicGo/QQ%E6%88%AA%E5%9B%BE20210118115520.png" srcset="/img/loading.gif" alt=""></p>
<p>如何提交一个镜像</p>
<h3 id="commit镜像"><a href="#commit镜像" class="headerlink" title="commit镜像"></a>commit镜像</h3><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 命令和git原理类似</span>
docker commit 提交容器成为一个新的副本

docker commit -m=&quot;描述信息&quot; -a=&quot;作者&quot; 容器id 目标镜像名:[TAG]</code></pre>
<p><strong>实战测试</strong></p>
<pre><code class="hljs shell">pi@raspbian:~$ docker images
REPOSITORY    TAG       IMAGE ID       CREATED         SIZE
redis         latest    aab98baa141a   4 days ago      98.6MB
tomcat        latest    688bd6a32df3   5 days ago      639MB
nginx         latest    9b016c5aa4e8   5 days ago      126MB
centos        latest    a0477e85b8ae   5 weeks ago     249MB
hello-world   latest    a29f45ccde2a   12 months ago   9.14kB</code></pre>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 1、启动一个默认的tomcat</span>
docker run -it -p 8080:8080 tomcat /bin/bash</code></pre>
<pre><code class="hljs shell">pi@raspbian:~$ curl localhost:8080
curl: (56) Recv failure: Connection reset by peer</code></pre>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 2、发现这个默认的tomcat 是没有webapps应用，官方的镜像默认webapps下面是没有文件的！拷贝文件进去</span></code></pre>
<pre><code class="hljs shell">pi@raspbian:~$ docker run -it -p 8080:8080 tomcat /bin/bash
root@31df0aa6fb9e:/usr/local/tomcat# ls
BUILDING.txt  CONTRIBUTING.md  LICENSE  NOTICE  README.md  RELEASE-NOTES  RUNNING.txt  bin  conf  lib  logs  native-jni-lib  temp  webapps  webapps.dist  work
root@31df0aa6fb9e:/usr/local/tomcat# cd webapps
root@31df0aa6fb9e:/usr/local/tomcat/webapps# ls
root@31df0aa6fb9e:/usr/local/tomcat/webapps# cd ..
root@31df0aa6fb9e:/usr/local/tomcat# cp -r webapps.dist/* webapps
root@31df0aa6fb9e:/usr/local/tomcat# exit
exit
pi@raspbian:~$ docker ps
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
pi@raspbian:~$ docker run -d -p 8080:8080 tomcat
52a80307a7fcea44519a75a452369adbdb53cc91b35cc6d0e614f02b2c23db4c
pi@raspbian:~$ curl localhost:8080
&lt;!doctype html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;&lt;title&gt;HTTP Status 404 – Not Found&lt;/title&gt;&lt;style type=&quot;text/css&quot;&gt;body &#123;font-family:Tahoma,Arial,sans-serif;&#125; h1, h2, h3, b &#123;color:white;background-color:#525D76;&#125; h1 &#123;font-size:22px;&#125; h2 &#123;font-size:16px;&#125; h3 &#123;font-size:14px;&#125; p &#123;font-size:12px;&#125; a &#123;color:black;&#125; .line &#123;height:1px;background-color:#525D76;border:none;&#125;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 404 – Not Found&lt;/h1&gt;&lt;hr class=&quot;line&quot; /&gt;&lt;p&gt;&lt;b&gt;Type&lt;/b&gt; Status Report&lt;/p&gt;&lt;p&gt;&lt;b&gt;Description&lt;/b&gt; The origin server did not find a current representation for the target resource or is not willing to disclose that one exists.&lt;/p&gt;&lt;hr class=&quot;line&quot; /&gt;&lt;h3&gt;Apache Tomcat/9.0.41&lt;/h3&gt;&lt;/body&gt;&lt;/html&gt;</code></pre>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 3、将操作过的容器通过commit调教为一个镜像！我们以后就使用我们修改过的镜像即可，这就是我们自己的一个修改的镜像。</span>
docker commit -m=&quot;描述信息&quot; -a=&quot;作者&quot; 容器id 目标镜像名:[TAG]</code></pre>
<pre><code class="hljs shell">pi@raspbian:~$ docker commit -m=&quot;kuangshen666&quot; -a=&quot;baixf&quot; 52a80307a7fc tomcat:1.0
sha256:83ac74acd5e011fa39241a5d1c4c43ad65cc9b6a68d5cbbac96db14917e6e000
pi@raspbian:~$ docker images
REPOSITORY    TAG       IMAGE ID       CREATED          SIZE
tomcat        1.0       83ac74acd5e0   17 seconds ago   639MB
redis         latest    aab98baa141a   4 days ago       98.6MB
tomcat        latest    688bd6a32df3   5 days ago       639MB
nginx         latest    9b016c5aa4e8   6 days ago       126MB
centos        latest    a0477e85b8ae   5 weeks ago      249MB
hello-world   latest    a29f45ccde2a   12 months ago    9.14kB</code></pre>
<p>如果你想要保存当前容器的状态，就可以通过commit来提交，获得一个镜像，就好比我们我们使用<strong>虚拟机的快照</strong>。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1og4y1q7M4?p=1">狂神说B站视频</a>
<a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-tutorial.html">学习docker</a>
<a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a target="_blank" rel="noopener" href="https://labs.play-with-docker.com/">使用docker</a>
<a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>
            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a>
                    
                      <a class="hover-with-bg" href="/categories/%E5%AD%A6%E4%B9%A0/Docker/">Docker</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Docker/">Docker</a>
                    
                      <a class="hover-with-bg" href="/tags/%E7%8B%82%E7%A5%9E/">狂神</a>
                    
                      <a class="hover-with-bg" href="/tags/nginx/">nginx</a>
                    
                      <a class="hover-with-bg" href="/tags/%E5%AE%B9%E5%99%A8/">容器</a>
                    
                      <a class="hover-with-bg" href="/tags/%E9%95%9C%E5%83%8F/">镜像</a>
                    
                      <a class="hover-with-bg" href="/tags/tomcat/">tomcat</a>
                    
                      <a class="hover-with-bg" href="/tags/redis/">redis</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/01/20/Docker/Docker%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Docker深入学习</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/01/15/%E6%9D%82%E8%B0%88/%E4%B8%AD%E5%9B%BD%E7%A8%8B%E5%BA%8F%E5%91%98%E5%AE%B9%E6%98%93%E5%8F%91%E9%9F%B3%E9%94%99%E8%AF%AF%E7%9A%84%E5%8D%95%E8%AF%8D/">
                        <span class="hidden-mobile">中国程序员容易发音错误的单词</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments">
                
                
  <div id="vcomments"></div>
  <script type="text/javascript">
    Fluid.utils.waitElementVisible('vcomments', function() {
      Fluid.utils.createScript('https://cdn.staticfile.org/valine/1.4.14/Valine.min.js', function () {
        new Valine({
          el: "#vcomments",
          app_id: "gn6pMOQ2Y8601y9txmR9s4DN-gzGzoHsz",
          app_key: "KYnH8MyyiQBXK8hMwO7HevEw",
          placeholder: "说点什么",
          path: window.location.pathname,
          avatar: "retro",
          meta: ["nick","mail","link"],
          pageSize: "10",
          lang: "zh-CN",
          highlight: false,
          recordIP: false,
          serverURLs: "",
        });
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the
    <a target="_blank" href="https://valine.js.org" rel="nofollow noopener noopener">comments powered by Valine.</a>
  </noscript>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <div> <span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span> <script src="/js/duration.js"></script> </div> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>

<!-- SCRIPTS -->

  <script  src="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":200})
    NProgress.start()
    document.addEventListener('DOMContentLoaded', function() {
      window.NProgress && window.NProgress.inc();
    })
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.staticfile.org/jquery/3.5.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.5.3/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script  src="https://cdn.staticfile.org/tocbot/4.12.0/tocbot.min.js" ></script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      var inputArea = document.querySelector("#local-search-input");
      inputArea.onclick = function () {
        searchFunc(path, 'local-search-input', 'local-search-result');
        this.onclick = null
      }
    })()
  </script>












  
    <!-- Baidu Analytics -->
    <script defer>
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?32cfe221d23ea3ac2ca847f1e865c570";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  

  

  

  

  

  





<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>



<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
